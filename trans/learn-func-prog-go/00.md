# 零、前言

直到最近，消息一直是*Go，而函数式编程不这样做*。

函数式编程（FP）非常适合多核并行处理。Go 是一个并发 baller（具有 Goroutines、channels 等），已经在每个可用的 CPU 核心上运行。FP 降低了复杂性；简单是 Go 最大的优势之一。

那么，FP 能带来什么，从而真正改善我们的软件应用程序呢？以下是它提供的功能：

*   **组合**：FP 向我们展示了如何分解应用程序，并通过重用小型构建块来重建它们。
*   **Monads**：使用 Monads，我们能够安全地将我们的工作流排序到数据转换管道中。
*   **错误处理**：我们可以利用一元错误处理，并且仍然保持与惯用 Go 代码的兼容性。
*   **性能**：引用透明度是指我们可以对函数进行一次评估，然后再参考其预先计算的值。
*   **表达代码**：FP 允许我们在代码中简洁地表达业务意图。我们声明了我们的函数所做的事情，没有在每次函数调用后进行杂乱无章的错误检查，也不必遵循状态更改（纯 FP 表示不可变变量）。
*   **更简单的代码**：没有共享数据意味着不必处理信号量、锁、竞争条件或死锁。

大多数人很难掌握 FP。

我也是。当我得到它时，我写了这本书。和我一起去旅行吧。我们将看到数百个插图，阅读易于理解的解释，并在此过程中在 Go 代码中实现 FP。

我喜欢当足球教练。我用来判断我是否成功成为一名教练的试金石测试就是这个简单问题的答案：*他们是否都注册参加下赛季并要求我成为他们的教练？*就像计划实践一样，我计划了每一章，从简单的概念开始，然后添加到其中。读了这本书，你也会说，*我明白了**。*

如果你想提高你的 FP 技能，这本书适合你。

## 这本书涵盖的内容

[第一章](01.html)，*Go*中的纯函数编程，介绍了编程的声明式风格，并使用斐波那契序列演示了递归、记忆和 Go 的并发结构。我们将学习如何对递归代码进行基准测试/性能测试，我们将得到一些坏消息。

[第 2 章](02.html)*操作集合*向我们展示了如何使用中间（映射、筛选和排序）和终端（Reduce、GroupBy 和 Join）函数来执行数据转换。我们使用类似 Mocha 的 BDD Go 框架来测试谓词函数。Itertools 帮助我们掌握 FP 集合操作功能的广度，我们研究一个分布式 MapReduce 解决方案：Gleam=Go+LuaJIT+Unix 管道。

[第 3 章](03.html)*使用高阶函数*列出了 27 个 FP 特征：匿名函数、闭包、currying、任意数据类型、一级函数、函数、函数组合、Hindley-Milner 类型系统、幂等性、不可变状态、不可变变量、Lambda 表达式、列表单子、，可能是数据类型，可能是单子，一元错误，处理，无副作用，运算符重载，选项类型，参数多态性，部分函数应用，递归，引用透明性，和或并集类型，尾部调用优化，类型类和单元类型。它还包括一个泛型示例，并说明了它对 FP 程序员的价值。我们使用 Goroutines 和 Go 通道实现 Map、Filter 和 Reduce 函数，以及惰性评估。

[第 4 章](04.html)、*Go*中的立体设计，讲述了 Gophers 为什么讨厌 Java、好的软件设计原则、如何应用单一责任原则、功能组合、打开/关闭原则、FP 契约和鸭子类型。它还涵盖了如何使用接口建模行为，如何使用接口分离原则和嵌入式接口组合软件。我们将学习紫色单群链的结合定律，并得到大的单子链连续体。

[第 5 章](05.html)*添加了功能和装饰*，说明了使用 Go 免费的读写器界面的界面组成。接下来，我们将学习如何将程序设计与功能控制反转进行比较。我们将实现以下装饰器：授权、日志记录和负载平衡。此外，我们还将向我们的应用程序添加简单的指标，以查看我们的装饰模式的实际效果。

[第 6 章](06.html)*在架构层面*应用 FP，采用分层架构构建应用框架，解决周期性依赖错误。我们将学习如何应用好莱坞原则以及观察者模式和依赖注入之间的区别。我们将使用控制反转（IoC）来控制逻辑流并构建分层应用程序。此外，我们将构建一个有效的表驱动框架来测试应用程序的 API。

[第 7 章](07.html)、*函数参数*告诉我们，为什么我们从 Java 和面向对象编程中学到的很多东西不适用于 Go，教给我们一种更好的方法来使用函数选项重构长参数列表，并帮助我们理解 curry 和 partial application 之间的区别。我们将学习如何应用部分应用程序创建另一个具有较小算术数的函数。我们将使用上下文优雅地关闭服务器，并了解如何使用上下文取消和回滚长时间运行的数据库事务。

[第 8 章](08.html)*使用流水线*提高性能，涵盖数据流类型（读取、拆分、转换、合并和写入），并教我们何时以及如何构建数据转换管道。我们使用缓冲来提高吞吐量，使用 goroutine 和 channels 来更快地处理数据，使用接口提高 API 的可读性，并实现一些有用的过滤器。我们还实现并比较了处理信用卡费用的命令式和功能性管道设计。

[第 9 章](09.html)、*函子、单群和泛型*让我们对 Go 中缺乏泛型支持表示赞赏。我们将看到如何使用代码生成工具来解决重复样板代码问题。我们将深入研究函数组合，实现一些函子，并学习如何在世界之间映射。我们还将学习如何编写 Reduce 函数来实现发票处理 monoid。

[第 10 章](10.html)、*单子、类型类和泛型*向我们展示了单子是如何工作的，并教我们如何使用绑定操作组合函数。它向我们展示了 monad 如何处理错误和处理输入/输出（I/O）。本章介绍 Go 中的一元工作流实现。我们将介绍什么是 Lambda 演算以及它与 monad 的关系，了解 Lambda 演算如何实现递归，并了解 Y-Combinator 如何在 Go 中工作。接下来，我们使用 Y-Combinator 来控制工作流，并学习如何处理管道末端的所有错误。我们将学习类型类如何工作，并在 Go 中实现一些。最后，我们回顾了 Go 中泛型的优缺点。

[第 11 章](11.html)，*范畴论应用*，让我们对范畴论有了一个实际的理解。我们将学会欣赏范畴论、逻辑和类型理论之间的深刻联系。我们将通过一次 FP 历史之旅来增加我们的理解。本章使用维恩图帮助解释各种编程语言。我们逐渐了解了在 lambda 表达式的上下文中绑定、咖喱和应用程序的含义。本章向我们展示了 Lambda 演算就像巧克力牛奶。本章涵盖 FP 的类型系统含义，向我们展示不同类别的同态以及何时使用它们，并使用数学和足球的飞行来增加我们对同态的理解。我们将介绍线性和二次函数的函数组合，并将学习接口驱动的开发。我们将探索知识驱动系统的价值，并学习如何运用我们对范畴论的理解来构建更好的应用程序。

[附录](00.html)、*杂项信息和 How Tos*向我们展示了作者在本书中建议我们如何构建和运行 Go 项目。它向我们展示了如何提出对 Go 的更改，介绍了词汇工作流解决方案：一种与 Go 兼容的方法来处理一个地方的错误，提供了一个提供反馈的地方和 FP 资源页面，讨论了 Minggatu Catalan 数字，并提供了一个世界和平的解决方案。

## 这本书你需要什么

如果您想运行每章中讨论的 Go 项目，您需要安装 Go。接下来，您需要运行 Go 开发环境并开始编写代码。

阅读*TL；*附录*中*如何建设和运行 Go 项目*一节的*博士小节。进入书中的[第一章](01.html)、*纯函数式编程，开始阅读*获取源代码*部分。继续阅读如何设置和运行第一个项目。*

其他Go资源包括：

*   Go之旅（[https://tour.golang.org/welcome/1](https://tour.golang.org/welcome/1) ）
*   举例说明（[https://gobyexample.com/](https://gobyexample.com/) ）
*   学习Go书（[https://www.miek.nl/go/](https://www.miek.nl/go/) ）
*   Go 语言规范（[https://golang.org/ref/spec](https://golang.org/ref/spec) ）

当我想到其他需要补充的东西时，我会把这些信息放在这里：[https://lexsheehan.blogspot.com/2017/11/what-you-need-for-this-book.html](https://lexsheehan.blogspot.com/2017/11/what-you-need-for-this-book.html) 。

## 这本书是给谁的

本书中的许多信息只需要高中教育。

对于本书中的编程部分，您应该至少有一年的编程经验。精通 Go 或 Haskell 是理想的，但有其他语言的经验，如 C/C++、Python、Javascript、Java、Scala 或 Ruby 也足够了。您应该熟悉使用命令行。

这本书应该吸引两个群体：

1.  非程序员（阅读[第 11 章](11.html)、*范畴论，适用于*），如果您是以下人员之一：

*   K-12 数学老师，想知道为什么你教的东西很重要吗
*   我是一名数学老师，我想看看你所教的与其他数学分支的关系
*   他是法学院的学生，想知道当你为你的当事人辩护时你会做什么
*   足球爱好者，喜欢数学
*   对学习范畴论感兴趣的人
*   热爱 Lambda 微积分，并希望看到用图表、图片和 Go 代码对其进行说明
*   软件项目经理，希望看到需求收集、实现和测试之间有更好的对应关系
*   C 级主管，希望了解是什么激励和激励您的 IT 员工

2.  程序员：如果你是其中之一：

*   软件爱好者，希望学习函数式编程
*   软件测试人员希望看到需求收集、实现和测试之间有更好的对应关系
*   软件架构师，希望了解如何使用 FP
*   去踢足球吧
*   Go developer 并希望用更具表现力的代码实现您的业务用例编程任务
*   去开发人员那里，想了解泛型
*   Java 开发人员，并希望理解为什么我们说，*l*ess 更重要
*   *您的语言*了解 FP 并希望转移您技能的开发者
*   开发人员正在寻找更好的方法来构建数据转换管道
*   Go developer 希望看到一种可行的方法来编写更少的代码，即，如果*出错，则编写更少的代码无*块
*   有经验的 Go 开发人员，希望学习 FP 或向工具箱中添加一些工具
*   参与软件开发并希望理解以下任何术语的人员。

如果您是一名 Go 开发人员，正在寻找工作代码，并逐行解释以下内容，本书适合您：

*   基准测试
*   并发（Goroutines/Channels）
*   咖喱
*   数据转换管道
*   装饰器模式
*   依赖注入
*   鸭子打字
*   嵌入接口
*   错误处理程序
*   功能组合
*   函数参数
*   函子
*   通过代码生成生成泛型
*   好莱坞原则
*   接口驱动开发
*   I18N（语言翻译）
*   国际奥委会
*   Go 中的 Lambda 表达式
*   分层应用框架
*   日志处理程序
*   单子
*   独异点
*   观察者模式
*   部分应用
*   处理信用卡付款的管道
*   递归
*   Reduce 函数用于合计发票总额
*   解决循环依赖错误
*   表驱动的 http API 测试框架
*   类型类
*   上传/下载文件到/从谷歌云存储桶
*   Y 组合器

如果我决定更改格式或更新此信息，我会将其放在此处：[http://lexsheehan .blogspot.com/2017/11/who-this-book-is-for.html](http://lexsheehan%C2%A0.blogspot.com/2017/11/who-this-book-is-for.html)。

## 习俗

在本书中，您将发现许多文本样式可以区分不同类型的信息。下面是这些风格的一些例子，并解释了它们的含义。文本中的代码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄如下所示：“我们更新代码，运行`glide-update`和`go-run`命令，并重复执行，直到完成。”代码块设置如下：

```go
func newSlice(s []string) *Collection {
  return &Collection{INVALID_INT_VAL, s}
}
```

当我们希望提请您注意代码块的特定部分时，相关行或项目以粗体显示：

```go
[default] 
exten => s,1,Dial(Zap/1|30) 
exten => s,2,Voicemail(u100) 
exten => s,102,Voicemail(b100) 
exten => i,1,Voicemail(s0) 
```

任何命令行输入或输出的编写方式如下：

```go
go get --help
```

**新术语**和**重要词语**以粗体显示。您在屏幕上（例如，在菜单或对话框中）看到的文字如下所示：“为了下载新模块，我们将转到文件|设置|项目名称|项目解释器。”

警告或重要提示如下所示。

提示和技巧如下所示。

## 读者反馈

我们欢迎读者的反馈。让我们知道你对这本书的看法你喜欢还是不喜欢。读者反馈对我们来说很重要，因为它可以帮助我们开发出您将真正从中获得最大收益的标题。要向我们发送总体反馈，只需发送电子邮件`feedback@packtpub.com`，并在邮件主题中提及该书的标题。如果您对某个主题有专业知识，并且您有兴趣撰写或贡献一本书，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

## 客户支持

既然您是一本 Packt 图书的骄傲拥有者，我们有很多东西可以帮助您从购买中获得最大收益。

### 下载示例代码

您可以从您的帐户[下载本书的示例代码文件 http://www.packtpub.com](http://www.packtpub.com) 。如果您在其他地方购买了本书，您可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support) 并注册，将文件直接通过电子邮件发送给您。您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。
2.  将鼠标指针悬停在顶部的“支持”选项卡上。
3.  点击代码下载和勘误表。
4.  在搜索框中输入图书的名称。
5.  选择要下载代码文件的书籍。

6.  从您购买本书的下拉菜单中选择。
7.  点击代码下载。

下载文件后，请确保使用以下最新版本解压或解压缩文件夹：

*   WinRAR/7-Zip for Windows
*   适用于 Mac 的 Zipeg/iZip/UnRarX
*   适用于 Linux 的 7-Zip/PeaZip

该书的代码包也托管在 GitHub 上的[https://github.com/PacktPublishing/Learning-Functional-Programming-in-Go](https://github.com/PacktPublishing/Learning-Functional-Programming-in-Go) 。我们在[上还提供了丰富的书籍和视频目录中的其他代码包 https://github.com/PacktPublishing/](https://github.com/PacktPublishing/) 。看看他们！

### 下载本书的彩色图像

我们还为您提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。彩色图像将帮助您更好地了解输出中的更改。您可以从[下载此文件 https://www.packtpub.com/sites/default/files/downloads/LearningFunctionalProgramminginGo_ColorImages.pdf](https://www.packtpub.com/sites/default/files/downloads/LearningFunctionalProgramminginGo_ColorImages.pdf) 。

### 勘误表

虽然我们已尽一切努力确保内容的准确性，但错误确实会发生。如果您在我们的一本书中发现错误，可能是文本或代码中的错误，如果您能向我们报告，我们将不胜感激。通过这样做，您可以使其他读者免于沮丧，并帮助我们改进本书的后续版本。如果您发现任何错误，请访问[进行报告 http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata) ，选择您的书籍，点击勘误表提交表单链接，然后输入勘误表的详细信息。一旦您的勘误表得到验证，您的提交将被接受，勘误表将上载到我们的网站或添加到该标题勘误表部分下的任何现有勘误表列表中。

要查看之前提交的勘误表，请转至[https://www.packtpub.com/books/content/support](https://www.packtpub.com/books/content/support) 并在搜索字段中输入图书名称。所需信息将出现在勘误表部分下。

### 盗版行为

在互联网上盗版版权材料是所有媒体都面临的一个持续问题。在 Packt，我们非常重视版权和许可证的保护。如果您在互联网上发现任何形式的非法复制品，请立即向我们提供地址或网站名称，以便我们采取补救措施。请致电`copyright@packtpub.com`与我们联系，并提供可疑盗版材料的链接。我们感谢您在保护我们的作者方面提供的帮助以及我们为您带来有价值内容的能力。

### 问题

如果您对本书的任何方面有任何问题，可以通过`questions@packtpub.com`与我们联系，我们将尽力解决该问题。